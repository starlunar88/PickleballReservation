# 밸런스 모드 1~8경기 로직 정리

## 기본 원칙
- **DUPR 점수만 사용** (내부 랭킹 미사용)
- 플레이어를 DUPR 점수 순으로 정렬: `sorted[0]` = 최강, `sorted[1]` = 차강, `sorted[2]` = 차약, `sorted[3]` = 최약
- 같은 점수 범위(0.15 이내)에서는 랜덤하게 섞기
- 각 경기마다 이전 경기와의 중복 방지

---

## 코트 1개 활성화 시 로직

### 1경기
- **플레이어 선택**: 전체 플레이어 중 DUPR 점수 순으로 상위 4명
- **팀 구성**: 
  - Team A: `sorted[0]` (최강) + `sorted[3]` (최약)
  - Team B: `sorted[1]` (차강) + `sorted[2]` (차약)
- **목적**: 완벽한 밸런스 조합 (최강+최약 vs 차강+차약)

### 2경기
- **플레이어 선택**: 전체 플레이어 중 DUPR 점수 순으로 상위 4명
- **팀 구성**: 
  - Team A: `sorted[0]` (최강) + `sorted[2]` (차약)
  - Team B: `sorted[1]` (차강) + `sorted[3]` (최약)
- **목적**: 1경기와 다른 밸런스 조합 (최강+차약 vs 차강+최약)
- **중복 방지**: 1경기와 같은 팀 조합이면 다른 조합 시도

### 3경기
- **플레이어 선택**: 1,2경기에 참여하지 않은 나머지 플레이어 + 상위 4명 중 일부
- **팀 구성**: 
  - Team A: `sorted[0]` (최강) + `sorted[3]` (최약)
  - Team B: `sorted[1]` (차강) + `sorted[2]` (차약)
- **목적**: 참여 기회 균등 분배

### 4경기
- **플레이어 선택**: 1,2경기에 참여하지 않은 나머지 플레이어 + 상위 4명 중 일부
- **팀 구성**: 
  - Team A: `sorted[0]` (최강) + `sorted[3]` (최약)
  - Team B: `sorted[1]` (차강) + `sorted[2]` (차약)
- **목적**: 참여 기회 균등 분배
- **중복 방지**: 3경기와 다른 조합 시도

### 5경기
- **플레이어 선택**: 상위 4명 (DUPR 점수 순)
- **팀 구성**: 
  - Team A: `sorted[0]` (최강) + `sorted[3]` (최약)
  - Team B: `sorted[1]` (차강) + `sorted[2]` (차약)
- **목적**: 밸런스 조합 (1,2 경기와 중복 방지)
- **중복 방지**: 1,2 경기와 같은 팀 조합이면 다른 조합 시도

### 6경기
- **플레이어 선택**: 상위 4명 (DUPR 점수 순)
- **팀 구성**: 
  - Team A: `sorted[0]` (최강) + `sorted[2]` (차약)
  - Team B: `sorted[1]` (차강) + `sorted[3]` (최약)
- **목적**: 밸런스 조합 (1,2,5 경기와 중복 방지)
- **중복 방지**: 1,2,5 경기와 같은 팀 조합이면 다른 조합 시도

### 7경기
- **플레이어 선택**: 상위 4명 (DUPR 점수 순)
- **팀 구성**: 
  - Team A: `sorted[0]` (최강) + `sorted[3]` (최약) 또는 `sorted[0]` (최강) + `sorted[2]` (차약)
  - Team B: `sorted[1]` (차강) + `sorted[2]` (차약) 또는 `sorted[1]` (차강) + `sorted[3]` (최약)
- **목적**: 밸런스 조합 (1,2 경기와 중복되지 않는)
- **중복 방지**: 1,2 경기와 같은 팀 조합이면 다른 밸런스 조합 사용
- **특징**: 코트가 1개일 때는 밸런스 조합 유지

### 8경기
- **플레이어 선택**: 상위 4명 (DUPR 점수 순)
- **팀 구성**: 
  - Team A: `sorted[0]` (최강) + `sorted[3]` (최약) 또는 `sorted[0]` (최강) + `sorted[2]` (차약)
  - Team B: `sorted[1]` (차강) + `sorted[2]` (차약) 또는 `sorted[1]` (차강) + `sorted[3]` (최약)
- **목적**: 밸런스 조합 (1,2,7 경기와 중복되지 않는)
- **중복 방지**: 1,2,7 경기와 같은 팀 조합이면 다른 밸런스 조합 사용
- **특징**: 코트가 1개일 때는 밸런스 조합 유지

---

## 코트 2개 이상 활성화 시 로직

### 1경기
- **플레이어 선택**: 
  - **홀수 코트 (1, 3, 5...)**: 상위 4명 (잘하는 사람들끼리)
  - **짝수 코트 (2, 4, 6...)**: 하위 4명 (못하는 사람들끼리)
- **팀 구성**: 
  - **홀수 코트**: 
    - Team A: `sorted[0]` (최강) + `sorted[1]` (차강)
    - Team B: `sorted[2]` (차약) + `sorted[3]` (최약)
  - **짝수 코트**: 
    - Team A: `sorted[0]` (하위 1위) + `sorted[1]` (하위 2위)
    - Team B: `sorted[2]` (하위 3위) + `sorted[3]` (하위 4위)
- **목적**: 코트별로 실력 그룹 분리 (상위 그룹 vs 하위 그룹)

### 2경기
- **플레이어 선택**: 
  - **홀수 코트**: 상위 4명
  - **짝수 코트**: 하위 4명
- **팀 구성**: 
  - **홀수 코트**: 
    - Team A: `sorted[0]` (최강) + `sorted[2]` (차약)
    - Team B: `sorted[1]` (차강) + `sorted[3]` (최약)
  - **짝수 코트**: 
    - Team A: `sorted[0]` (하위 1위) + `sorted[2]` (하위 3위)
    - Team B: `sorted[1]` (하위 2위) + `sorted[3]` (하위 4위)
- **목적**: 1경기와 다른 조합 (중복 방지)

### 3경기
- **플레이어 선택**: 1,2경기에 참여하지 않은 나머지 플레이어 + 상위 4명 중 일부
- **팀 구성**: 
  - Team A: `sorted[0]` (최강) + `sorted[3]` (최약)
  - Team B: `sorted[1]` (차강) + `sorted[2]` (차약)
- **목적**: 참여 기회 균등 분배

### 4경기
- **플레이어 선택**: 1,2경기에 참여하지 않은 나머지 플레이어 + 상위 4명 중 일부
- **팀 구성**: 
  - Team A: `sorted[0]` (최강) + `sorted[3]` (최약)
  - Team B: `sorted[1]` (차강) + `sorted[2]` (차약)
- **목적**: 참여 기회 균등 분배
- **중복 방지**: 3경기와 다른 조합 시도

### 5경기
- **플레이어 선택**: 상위 4명 (DUPR 점수 순)
- **팀 구성**: 
  - Team A: `sorted[0]` (최강) + `sorted[3]` (최약)
  - Team B: `sorted[1]` (차강) + `sorted[2]` (차약)
- **목적**: 밸런스 조합 (1,2 경기와 중복 방지)
- **중복 방지**: 1,2 경기와 같은 팀 조합이면 다른 조합 시도

### 6경기
- **플레이어 선택**: 상위 4명 (DUPR 점수 순)
- **팀 구성**: 
  - Team A: `sorted[0]` (최강) + `sorted[2]` (차약)
  - Team B: `sorted[1]` (차강) + `sorted[3]` (최약)
- **목적**: 밸런스 조합 (1,2,5 경기와 중복 방지)
- **중복 방지**: 1,2,5 경기와 같은 팀 조합이면 다른 조합 시도

### 7경기
- **플레이어 선택**: 상위 4명 (DUPR 점수 순)
- **팀 구성**: 
  - Team A: `sorted[0]` (최강) + `sorted[1]` (차강)
  - Team B: `sorted[2]` (차약) + `sorted[3]` (최약)
- **목적**: 잘하는 사람들끼리 vs 못하는 사람들끼리 (1,2 경기와 같은 조합이지만 중복 방지)
- **중복 방지**: 1,2 경기와 같은 팀 조합이면 다른 조합 시도
- **특징**: 코트가 2개 이상일 때는 실력별 그룹 경기

### 8경기
- **플레이어 선택**: 하위 4명 (DUPR 점수 낮은 순)
- **팀 구성**: 
  - Team A: `sorted[2]` (하위 3위) + `sorted[3]` (하위 4위)
  - Team B: `sorted[0]` (하위 1위) + `sorted[1]` (하위 2위)
- **목적**: 못하는 사람들끼리 vs 못하는 사람들끼리 (1,2,7 경기와 중복 방지)
- **중복 방지**: 1,2,7 경기와 같은 팀 조합이면 다른 조합 시도
- **특징**: 코트가 2개 이상일 때는 하위 그룹 경기

---

## 주요 차이점 요약

| 경기 | 코트 1개 | 코트 2개 이상 |
|------|---------|--------------|
| **1경기** | 밸런스 조합 (최강+최약 vs 차강+차약) | 홀수 코트: 상위 그룹, 짝수 코트: 하위 그룹 |
| **2경기** | 밸런스 조합 (최강+차약 vs 차강+최약) | 홀수 코트: 상위 그룹, 짝수 코트: 하위 그룹 |
| **7경기** | 밸런스 조합 유지 | 잘하는 사람들끼리 vs 못하는 사람들끼리 |
| **8경기** | 밸런스 조합 유지 | 못하는 사람들끼리 vs 못하는 사람들끼리 |

---

## 코드 위치 참조

- **플레이어 선택 로직**: `app.js` 10700-10848 라인
- **팀 구성 로직 (코트 1개)**: `app.js` 12380-12514 라인
- **팀 구성 로직 (코트 2개 이상)**: `app.js` 12743-12985 라인
- **7경기 특별 처리**: `app.js` 12314-12354, 12833-12917 라인
- **8경기 특별 처리**: `app.js` 12323-12354, 12918-12984 라인

